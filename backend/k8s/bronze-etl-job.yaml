apiVersion: batch/v1
kind: Job
metadata:
  name: bronze-etl
spec:
  backoffLimit: 3
  template:
    spec:
      serviceAccountName: big-five-pipeline-sa
      restartPolicy: Never
      containers:
        - name: bronze-etl
          image: gcr.io/big-five-analytics/big-five-etl:prod-v4
          command: ["python", "bronze_etl.py"]
          env:
            - name: GCP_PROJECT
              value: "big-five-analytics"
            - name: DATASET
              value: "big_five_dataset"
            - name: BRONZE_TABLE
              value: "bronze"
            - name: LOG_LEVEL
              value: "INFO"
            - name: PERIOD
              value: "6mo"
            - name: INTERVAL
              value: "1h"
          resources:
            requests:
              cpu: "500m"
              memory: "1Gi"
            limits:
              cpu: "1"
              memory: "2Gi"
